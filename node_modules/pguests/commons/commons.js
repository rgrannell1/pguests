
"use strict"





const commons = {
	async: { },
	sort:  { }
}





commons.padString = (num, str) => {

	for (var ith = str.length; ith < num; ++ith) {
		str += ' '
	}

	return str

}

commons.maxByKeys = (fn, keys, objs) => {

	return objs.map(obj => {

		var out = { }

		keys.forEach(key => {
			out[key] = Math.max( out[key], fn(obj[key]) )
		})

		return out

	})

}





commons.async.map = function (fn, data, callback, acc) {

	acc = acc || [ ]

	if (data.length === 0) {
		callback(acc)
	} else {

		fn(data[0], function ( ) {

			commons.async.map(
				fn, data.slice(1), callback,
				acc.concat( [Array.prototype.slice.call(arguments)] ))

		})

	}

}





commons.sort.byPort = (port0, port1) => {

}

commons.sort.byIp = (ipData0, ipData1) => {
	/*
		algorithm credit to Dan on StackOverflow;
		will allow ipv4 / ipv6 sorting.
	*/

	var bits = [ipData0, ipData1].map(ipData => {

		if (ipData.ipVersion === 'ipv4') {

			// convert ip to a single number.
			return ipData.split('.')
				.reverse( )
				.map((ith, part) => {
					return parseInt(part) * Math.pow(256, (ith + 1))
				})
				.reduce((acc, num) => {
					return acc + num
				})

		}


	})

}



module.exports = commons
