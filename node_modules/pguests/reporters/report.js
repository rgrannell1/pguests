
"use strict"





const commons  = require('pguests/commons/commons')
const constants = require('pguests/commons/constants')





var report = function (events) {

	const remoteIps = commons.groupBy(event => {
		return event.socket.remote.ip
	}, events)

	Object.keys(remoteIps).forEach(ip => {

		console.log(ip)
		const remotePorts = remoteIps[ip]

		remotePorts.forEach(event => {

			const service  = event.socket.remote.service
			const hostname = event.socket.remote.hostname

			const displayService  = service  ? service  : event.socket.remote.port
			const displayHostname = hostname ? hostname : constants.messages.unknownHost

			console.log(`    ${displayService}    ${displayHostname}`)

		})


	})

}





module.exports = report
