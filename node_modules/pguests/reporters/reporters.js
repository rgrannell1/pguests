
"use strict"





const constants = require('pguests/commons/constants')





const reporters = { }





reporters.reportRates = received =>{

	var sockets = received.map(socket => {

		var reformatted = {
			local:     socket.local_address,
			remote:    socket.remote_address || socket.rem_address,
			metadata:  socket.metadata
		}

		return reformatted

	})

	var profiles = sockets.reduce((acc, socket) => {

		var localAddress = `${socket.local.ip}:${socket.local.port}`

		if (!acc.hasOwnProperty(socket.remote.ip)) {

			acc[socket.remote.ip] = {
				[socket.remote.port]: [localAddress]
			}

		} else if (acc[socket.remote.ip][socket.remote.port].indexOf(localAddress) === -1) {

			acc[socket.remote.ip][socket.remote.port].push(localAddress)

		}

		return acc

	}, { })

	console.log( profiles )

}





module.exports = reporters
